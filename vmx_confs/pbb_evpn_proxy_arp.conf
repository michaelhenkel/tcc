## Last changed: 2017-03-17 05:18:52 UTC
version 17.2-20170302_dev_common.0;
system {
    root-authentication {
        encrypted-password "$5$5IWIUyEr$iQnfyPDhvlQBMg3QLxZ30LbKlVlMTKR8rsj8.1s9ZK7"; ## SECRET-DATA
    }
    services {
        ssh {
            root-login allow;
        }
    }
    syslog {
        user * {
            any emergency;
        }
        file messages {
            any notice;
            authorization info;
        }
        file interactive-commands {
            interactive-commands any;
        }
    }
    license {
        keys;
    }
}
chassis {
    fpc 0 {
        pic 0 {
            tunnel-services {
                bandwidth 10g;
            }
        }
    }
    network-services enhanced-ip;
}
interfaces {
    ge-0/0/0 {
        mtu 9000;
        unit 0 {
            family inet {
                address 192.168.1.199/24;
            }
        }
    }
    lt-0/0/0 {
        unit 0 {
            encapsulation vlan-bridge;
            vlan-id 2;
            peer-unit 1;
            family bridge;
        }
        unit 1 {
            encapsulation vlan-bridge;
            vlan-id 2;
            peer-unit 0;
            family bridge;
        }
    }
    ge-0/0/1 {
        flexible-vlan-tagging;
        mtu 9000;
        encapsulation flexible-ethernet-services;
        unit 1 {
            encapsulation vlan-bridge;
            vlan-id 1;
        }
        unit 2 {
            encapsulation vlan-bridge;
            vlan-id 2;
        }
        unit 3 {
            encapsulation vlan-bridge;
            vlan-id 3;
        }
    }
    ge-0/0/2 {
        flexible-vlan-tagging;
        mtu 9000;
        encapsulation flexible-ethernet-services;
        unit 4 {
            encapsulation vlan-bridge;
            vlan-id 4;
        }
        unit 5 {
            encapsulation vlan-bridge;
            vlan-id 5;
        }
        unit 6 {
            encapsulation vlan-bridge;
            vlan-id 6;
        }
    }
    cbp0 {
        unit 1000 {
            family bridge {
                interface-mode trunk;
                bridge-domain-type bvlan;
                isid-list all;
            }
        }
        unit 1001 {
            family bridge {
                interface-mode trunk;
                bridge-domain-type bvlan;
                isid-list all;
            }
        }
        unit 1002 {
            family bridge {
                interface-mode trunk;
                bridge-domain-type bvlan;
                isid-list all;
            }
        }
        unit 1003 {
            family bridge {
                interface-mode trunk;
                bridge-domain-type bvlan;
                isid-list all;
            }
        }
    }
    fxp0 {
        unit 0 {
            family inet {
                dhcp;
            }
            family mpls;
        }
    }
    irb {
        unit 2 {
            proxy-arp unrestricted;
            family inet {
                address 2.0.0.2/24;
            }
        }
        unit 3 {
            family inet {
                address 3.0.0.10/24;
            }
        }
        unit 4 {
            family inet {
                address 41.0.0.1/24;
            }
        }
        unit 5 {
            family inet {
                address 51.0.0.1/24;
            }
        }
        unit 6 {
            family inet {
                address 61.0.0.1/24;
            }
        }
    }
    lo0 {
        unit 4 {
            family inet {
                address 40.0.0.1/32;
            }
        }
        unit 5 {
            family inet {
                address 50.0.0.1/32;
            }
        }
        unit 6 {
            family inet {
                address 60.0.0.1/32;
            }
        }
    }
    pip0 {
        unit 1000 {
            family bridge {
                interface-mode trunk;
                bridge-domain-type svlan;
                isid-list all-service-groups;
            }
        }
        unit 1001 {
            family bridge {
                interface-mode trunk;
                bridge-domain-type svlan;
                isid-list all-service-groups;
            }
        }
        unit 1002 {
            family bridge {
                interface-mode trunk;
                bridge-domain-type svlan;
                isid-list all-service-groups;
            }
        }
        unit 1003 {
            family bridge {
                interface-mode trunk;
                bridge-domain-type svlan;
                isid-list all-service-groups;
            }
        }
    }
}
routing-options {
    route-distinguisher-id 192.168.1.199;
    autonomous-system 64512;
    dynamic-tunnels {
        contrail {
            source-address 192.168.1.199;
            gre;
            destination-networks {
                192.168.1.0/24;
            }
        }
    }
}
protocols {
    mpls {
        interface all;
        interface fxp0.0;
    }
    bgp {
        group contrail {
            type internal;
            local-address 192.168.1.199;
            family inet-vpn {
                unicast;
            }
            family evpn {
                signaling;
            }
            family route-target;
            allow 192.168.1.0/24;
            neighbor 192.168.1.130;
        }
    }
    l2-learning {
        traceoptions {
            file l2-learning.log;
            flag all;
        }
    }
}
policy-options {
    policy-statement udp {
        term 1 {
            from protocol direct;
            then {
                community add udp;
                accept;
            }
        }
    }
    community udp members 0x030c:1:2;
}
routing-instances {
    svc1-b-comp {
        instance-type virtual-switch;
        interface cbp0.1001;
        vrf-target target:1:1;
        protocols {
            evpn {
                control-word;
                pbb-evpn-core;
                extended-isid-list [ 10001 1001 ];
            }
        }
        bridge-domains {
            svc1-bd {
                vlan-id 401;
                isid-list [ 1001 10001 ];
                vlan-id-scope-local;
            }
        }
    }
    svc1-i-comp {
        instance-type virtual-switch;
        interface pip0.1001;
        bridge-domains {
            br-1 {
                vlan-id 1;
                interface ge-0/0/1.1;
            }
        }
        pbb-options {
            peer-instance svc1-b-comp;
        }
        service-groups {
            cust1 {
                service-type elan;
                pbb-service-options {
                    isid 1001 vlan-id-list 1;
                }
            }
        }
    }
    svc2-b-comp {
        instance-type virtual-switch;
        interface cbp0.1002;
        vrf-target target:1:2;
        protocols {
            evpn {
                control-word;
                pbb-evpn-core;
                extended-isid-list [ 10002 1002 ];
            }
        }
        bridge-domains {
            svc2-bd {
                vlan-id 402;
                isid-list [ 1002 10002 ];
                vlan-id-scope-local;
            }
        }
    }
    svc2-i-comp {
        instance-type virtual-switch;
        interface pip0.1002;
        bridge-domains {
            br-2 {
                vlan-id 2;
                interface ge-0/0/1.2;
                interface lt-0/0/0.1;
            }
        }
        pbb-options {
            peer-instance svc2-b-comp;
        }
        service-groups {
            cust2 {
                service-type elan;
                pbb-service-options {
                    isid 1002 vlan-id-list 2;
                }
            }
        }
    }
    svc2-l3 {
        instance-type virtual-switch;
        vrf-target target:2:1;
        bridge-domains {
            svc2-l3-bd {
                vlan-id 2;
                interface lt-0/0/0.0;
                routing-interface irb.2;
            }
        }
    }
    svc3-b-comp {
        instance-type virtual-switch;
        interface cbp0.1003;
        vrf-target target:1:3;
        protocols {
            evpn {
                control-word;
                pbb-evpn-core;
                extended-isid-list [ 10003 1003 ];
            }
        }
        bridge-domains {
            svc3-bd {
                vlan-id 403;
                isid-list [ 1003 10003 ];
                vlan-id-scope-local;
            }
        }
    }
    svc3-i-comp {
        instance-type virtual-switch;
        interface pip0.1003;
        bridge-domains {
            br-3 {
                vlan-id 3;
                interface ge-0/0/1.3;
            }
        }
        pbb-options {
            peer-instance svc3-b-comp;
        }
        service-groups {
            cust3 {
                service-type elan;
                pbb-service-options {
                    isid 1003 vlan-id-list 3;
                }
            }
        }
    }
    svc4 {
        instance-type vrf;
        interface ge-0/0/2.0;
        interface irb.4;
        interface lo0.4;
        vrf-target target:1:4;
        vrf-table-label;
    }
    svc5 {
        instance-type vrf;
        interface irb.5;
        interface lo0.5;
        vrf-target target:1:5;
        vrf-table-label;
    }
    svc6 {
        instance-type vrf;
        interface irb.6;
        interface lo0.6;
        vrf-target target:1:6;
        vrf-table-label;
    }
}
bridge-domains {
    svc4 {
        domain-type bridge;
        vlan-id 4;
        interface ge-0/0/2.4;
        routing-interface irb.4;
    }
    svc5 {
        domain-type bridge;
        vlan-id 5;
        interface ge-0/0/2.5;
        routing-interface irb.5;
    }
    svc6 {
        domain-type bridge;
        vlan-id 6;
        interface ge-0/0/2.6;
        routing-interface irb.6;
    }
}
